<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM - Início</title>
    <link rel="stylesheet" href="/styles/crm-core.css">
    <link rel="stylesheet" href="/styles/crm-sobre.css">
    <link rel="stylesheet" href="/styles/crm-chatbot-shell.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <div class="crm-layout">
        <aside id="crmSidebar" class="crm-sidebar" aria-label="Navegação principal">
            <button id="sidebarToggle" class="sidebar-toggle sidebar-toggle-inside" type="button" aria-label="Abrir menu" aria-expanded="false" aria-controls="crmSidebar">
                <i class="fa-solid fa-headset" aria-hidden="true"></i>
            </button>
            <div class="sidebar-logo">
                <i class="fa-solid fa-headset" aria-hidden="true"></i>
                <span>CRM Chatbot</span>
            </div>
            <nav aria-label="Seções">
                <ul role="menu">
                    <li id="menu-clientes" class="active" role="menuitem" tabindex="0">
                        <i class="fa-solid fa-users" aria-hidden="true"></i>
                        <span>Clientes</span>
                    </li>
                    <li id="menu-consultores" role="menuitem" tabindex="0">
                        <i class="fa-solid fa-user-tie" aria-hidden="true"></i>
                        <span>Consultores</span>
                    </li>
                    <li id="menu-sobre" role="menuitem" tabindex="0">
                        <i class="fa-solid fa-circle-info" aria-hidden="true"></i>
                        <span>Sobre</span>
                    </li>
                </ul>
            </nav>
            <div id="userInfo" class="sidebar-user" aria-live="polite" style="display:flex;align-items:center;gap:.6rem;">
                <!-- Populado dinamicamente com avatar + nome + email -->
                <div class="placeholder" style="width:32px;height:32px;border-radius:50%;background:#2563eb;opacity:.3;"></div>
                <div style="display:flex;flex-direction:column;line-height:1.1;">
                    <strong style="font-size:.7rem;opacity:.6;">Carregando...</strong>
                    <small style="font-size:.6rem;opacity:.35;">—</small>
                </div>
            </div>
            <div class="sidebar-logout-wrapper">
                <button id="logoutBtn" type="button" class="btn btn-danger">
                    <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
                    <span>Sair</span>
                </button>
            </div>
        </aside>

    <div class="crm-sidebar-overlay" id="sidebarOverlay" hidden aria-hidden="true"></div>

        <div class="crm-main">
            <header class="crm-header-top">
                <h1>Painel Administrativo</h1>
                <div class="crm-header-actions" style="display:flex;align-items:center;gap:.65rem;">
                    <button id="addClientBtn" class="btn btn-primary" type="button">
                        <i class="fa-solid fa-plus" aria-hidden="true"></i>
                        <span>Novo Cliente</span>
                    </button>
                </div>
            </header>

            <main id="app" aria-live="polite">
                <div id="view-root"></div>
            </main>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">Editar Cliente</h2>
            <div id="validation-summary" class="validation-summary" aria-live="assertive" aria-atomic="true" style="display:none"></div>
            <label>Nome:</label>
            <input type="text" id="editNome">
            <label>E-mail:</label>
            <input type="text" id="editEmail">
            <label>Telefone:</label>
            <input type="text" id="editTelefone">
            <label>Cidade:</label>
            <input type="text" id="editCidade">
            <label>Máquina:</label>
            <select id="editMaquina">
                <option value="">Selecione uma máquina</option>
            </select>
            <label>Consultor:</label>
            <select id="editConsultor" disabled>
                <option value="">Selecione uma máquina primeiro</option>
            </select>
            <label>Horário:</label>
            <input type="text" id="editHorario">
            <label>Status:</label>
            <select id="editStatus">
                <option value="novo">Novo</option>
                <option value="em andamento">Em andamento</option>
                <option value="contatado">Contatado</option>
                <option value="convertido">Convertido</option>
                <option value="perdido">Perdido</option>
            </select>
            <div class="modal-buttons">
                <button id="saveEdit">Salvar</button>
                <button id="cancelEdit">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="chatbot-widget">
        <button id="open-chatbot" aria-label="Abrir chatbot" aria-expanded="false" title="Abrir Chatbot" class="chatbot-fab">
            <span class="visually-hidden">Abrir Chatbot</span>
            <i class="fa-solid fa-robot chatbot-fab-icon" aria-hidden="true"></i>
            <span class="fab-glow" aria-hidden="true"></span>
        </button>
        <div id="chatbot-popup" style="display:none;">
            <iframe src="/html/chatbot.html" frameborder="0" id="chatbot-iframe" title="Chatbot"></iframe>
        </div>
    </div>

    <div class="toast-container" id="crm-toast-container" aria-live="polite" aria-atomic="false"></div>
    <script type="module" src="/js/crm/index.js"></script>
    <script src="/js/crm/userMenu.js" defer></script>
</body>
</html>